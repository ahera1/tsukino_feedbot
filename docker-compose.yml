version: '3.8'

services:

  # デフォルトサービス（デーモンモード）
  feedbot:
    build: .
    container_name: tsukino-feedbot
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    env_file:
      - .env
    environment:
      - TZ=Asia/Tokyo
      - RUN_MODE=daemon
    restart: unless-stopped

  # ワンショット実行用（必要時のみ）
  feedbot-once:
    build: .
    container_name: tsukino-feedbot-once
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    env_file:
      - .env
    environment:
      - TZ=Asia/Tokyo
      - RUN_MODE=once
    profiles:
      - once

  # ステータス確認用（必要時のみ）
  feedbot-status:
    build: .
    container_name: tsukino-feedbot-status
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    env_file:
      - .env
    environment:
      - TZ=Asia/Tokyo
      - RUN_MODE=status
    profiles:
      - status
